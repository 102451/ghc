/* stuff to have before we get going */
MsubNeededHere(ghc)
UnlitNeededHere(depend)

DYN_LOADABLE_BITS = \
	ghc-asm.prl \
	ghc-recomp.prl \
	ghc-iface.prl \
	ghc-consist.prl \
	ghc-split.prl

/* Literate-pgmming suffix rules used herein */
UnlitSuffixRule(.lprl,.prl)

MsubMakefileDependentProgramScriptTarget(PerlCmd,ghc,ghc.prl,/*no flags*/,/*Makefile*/)
AllTarget( $(DYN_LOADABLE_BITS) )

/* installation is hackish: because we may want to install w/ a diff name */
#if DoInstallGHCSystem == YES
MakeDirectories(install, $(INSTBINDIR_GHC) $(INSTLIBDIR_GHC))

InstallMsubbedScriptTarget(PerlCmd,ghc-v-temp-name,ghc.prl,$(INSTBINDIR_GHC))
/* and continuing ... */
install::
	$(MV) $(INSTBINDIR_GHC)/ghc-v-temp-name $(INSTBINDIR_GHC)/$(GHC_DRIVER_INST_NAME)
	$(RM) $(INSTBINDIR_GHC)/ghc-v-temp-name

dyn_loadable_bits : $(DYN_LOADABLE_BITS)

InstallMultNonExecTargets(dyn_loadable_bits, $(DYN_LOADABLE_BITS), $(INSTLIBDIR_GHC))

install :: install_dyn_loadable_bits

#endif /* DoInstallGHCSystem */

depend::
	@echo make depend done in $(CURRENT_DIR)

ExtraStuffToClean( ghc.prl $(DYN_LOADABLE_BITS) )

ClearTagsFile()

DYN_LOADABLE_LPRLS = $(DYN_LOADABLE_BITS:.prl=.lprl)
PerlTagsTarget( ghc.lprl $(DYN_LOADABLE_LPRLS) )

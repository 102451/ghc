

================================================================================
Typechecked:
{- nonrec -}
{- nonrec -}
AbsBinds [] [] [([], fubar{-r1,x-}, fubar_aZa)]
    fubar_aZa
	=   STBase.seqPrimIO{-r46,p-}
		[PrelBase.(){-40,p-}, PrelBase.Int{-3g,p-}]
		(STBase.ST{-5G,p-}{i}
		     [GHC.RealWorld{-3s,p-}, PrelBase.(){-40,p-}]
		     _ccall_ f)
		(STBase.ST{-5G,p-}{i}
		     [GHC.RealWorld{-3s,p-}, PrelBase.Int{-3g,p-}]
		     _ccall_ b)
{- nonrec -}


================================================================================
Desugared:
fubar_aZa  :: 
    STBase.PrimIO{-3P,p-} PrelBase.Int{-3g,p-}
{-# L #-}
fubar_aZa =
    let { ds_d110  :: 
	      STBase.ST{-3O,p-} GHC.RealWorld{-3s,p-} PrelBase.(){-40,p-}
	  {-# L #-}
	  ds_d110 =
      let {
	ds_d11g  :: 
	    STBase.State{-3M,p-} GHC.RealWorld{-3s,p-}
	    -> (PrelBase.(){-40,p-}, STBase.State{-3M,p-} GHC.RealWorld{-3s,p-})
	{-# L #-}
	ds_d11g =
	    \ ds_d11m  :: 
		  STBase.State{-3M,p-} GHC.RealWorld{-3s,p-}
	      {-# L #-}
	      ds_d11m ->
		case ds_d11m of { STBase.S#{-5D,p-}{i} ds_d11x  ->
		case
		    _ccall_ f [(STBase.State{-3M,p-} GHC.RealWorld{-3s,p-}) (GHC.State#{-3L,p-} GHC.RealWorld{-3s,p-})]!
			ds_d11x
		of {
		STBase.S#{-5D,p-}{i} ds_d11X  ->
		let {
		  ds_d11Q  :: 
		      STBase.State{-3M,p-} GHC.RealWorld{-3s,p-}
		  {-# L #-}
		  ds_d11Q =
		      STBase.S#{-5D,p-}{i}
			  {_@_ GHC.RealWorld{-3s,p-} ds_d11X}
		} in 
		  PrelTup.(,){-62,p-}{i}
		      {_@_ PrelBase.(){-40,p-}
		       _@_ (STBase.State{-3M,p-} GHC.RealWorld{-3s,p-})
		       PrelBase.(){-60,p-}{i}
		       ds_d11Q};};}
      } in 
	STBase.ST{-5G,p-}{i}
	    _@_ GHC.RealWorld{-3s,p-} _@_ PrelBase.(){-40,p-} ds_d11g
    } in
    let { ds_d114  :: 
	      STBase.ST{-3O,p-} GHC.RealWorld{-3s,p-} PrelBase.Int{-3g,p-}
	  {-# L #-}
	  ds_d114 =
      let {
	ds_d12a  :: 
	    STBase.State{-3M,p-} GHC.RealWorld{-3s,p-}
	    -> (PrelBase.Int{-3g,p-}, STBase.State{-3M,p-} GHC.RealWorld{-3s,p-})
	{-# L #-}
	ds_d12a =
	    \ ds_d12g  :: 
		  STBase.State{-3M,p-} GHC.RealWorld{-3s,p-}
	      {-# L #-}
	      ds_d12g ->
		case ds_d12g of { STBase.S#{-5D,p-}{i} ds_d12r  ->
		case
		    _ccall_ b [(STBase.StateAndInt#{-3D,p-} GHC.RealWorld{-3s,p-}) (GHC.State#{-3L,p-} GHC.RealWorld{-3s,p-})]!
			ds_d12r
		of {
		STBase.StateAndInt#{-5v,p-}{i} ds_d12U ds_d12S  ->
		let {
		  ds_d12J  :: 
		      PrelBase.Int{-3g,p-}
		  {-# L #-}
		  ds_d12J =
		      PrelBase.I#{-5b,p-}{i}
			  {ds_d12S} } in
		let {
		  ds_d12N  :: 
		      STBase.State{-3M,p-} GHC.RealWorld{-3s,p-}
		  {-# L #-}
		  ds_d12N =
		      STBase.S#{-5D,p-}{i}
			  {_@_ GHC.RealWorld{-3s,p-} ds_d12U}
		} in 
		  PrelTup.(,){-62,p-}{i}
		      {_@_ PrelBase.Int{-3g,p-}
		       _@_ (STBase.State{-3M,p-} GHC.RealWorld{-3s,p-})
		       ds_d12J
		       ds_d12N};};}
      } in 
	STBase.ST{-5G,p-}{i}
	    _@_ GHC.RealWorld{-3s,p-} _@_ PrelBase.Int{-3g,p-} ds_d12a
    } in
    STBase.seqPrimIO{-r46,p-}
	_@_ PrelBase.(){-40,p-} _@_ PrelBase.Int{-3g,p-} ds_d110 ds_d114
fubar{-r1,x-}  :: 
    STBase.PrimIO{-3P,p-} PrelBase.Int{-3g,p-}
{-# L #-}
fubar{-r1,x-} =
    fubar_aZa

NOTE: Simplifier still going after 4 iterations; bailing out.
